(function(){tinymce.create("org.olat.core.gui.components.form.flexible.impl.elements.richText.plugins.quotespliter",{init:function(a,b){a.on("KeyDown",function(d,g){if(g==null||g.keyCode!=13||!d.selection.isCollapsed()){return}var c=d.selection.getNode();if(c==null){return}if(h(c)){tinymce.dom.Event.cancel(g);f(c)}function h(e){var j=d.dom.getParent(e,"DIV");var i=d.dom.getParent(e,"BLOCKQUOTE");if(j&&i&&j.className=="b_quote_wrapper"){return true}return false}function f(o){var p=d.dom.getParents(o);var s="";var k="";for(var n=0;n<p.length;n++){var q=p[n];s+="</"+q.nodeName+">";if(q.className=="b_quote_wrapper"){var r='<div class="b_quote_wrapper"><div class="b_quote_author mceNonEditable">';for(var l=0;l<q.childNodes.length;l++){if(q.childNodes[l].className=="b_quote_author mceNonEditable"){r+=q.childNodes[l].innerHTML;break}}k=r+"</div>"+k;if(!h(q)){break}}else{k="<"+q.nodeName+' class="'+q.className+'">'+k}}var e=s+'<p><span id="quote_spliter_marker"></span><br/></p>'+k;d.execCommand("mceInsertRawHTML",true,e);var m=d.dom.get("quote_spliter_marker");if(m){d.selection.select(m);d.selection.collapse();d.execCommand("mceRemoveNode",true,m)}}})},getInfo:function(){return{longname:"Olat Quote Spliter",author:"frentix GmbH",authorurl:"http://www.frentix.com",infourl:"http://www.frentix.com",version:"1.0"}}});tinymce.PluginManager.add("quotespliter",org.olat.core.gui.components.form.flexible.impl.elements.richText.plugins.quotespliter)})();